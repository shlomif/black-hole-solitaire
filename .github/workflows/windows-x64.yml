# This file is GENERATED BY
# black-hole-solitaire/CI-testing/translate-travis.yml-to-github-actions.py
jobs:
    perl:
        runs-on: windows-latest
        steps:
        -   name: Setup perl
            uses: shogo82148/actions-setup-perl@v1
            with:
                distribution: strawberry
                perl-version: ${{ matrix.perl-version }}
        -   name: Set git to use LF
            run: 'git config --global core.autocrlf false

                git config --global core.eol lf

                '
        -   uses: actions/checkout@v2
            with:
                submodules: 'true'
        -   name: perl -V
            run: perl -V
        -   name: install cpanm and mult modules
            uses: perl-actions/install-with-cpanm@v1
            with:
                install: 'Code::TidyAll::Plugin::ClangFormat

                    Code::TidyAll::Plugin::TestCount

                    Dir::Manifest

                    Dist::Zilla

                    Env::Path

                    Games::Solitaire::Verify::Solution

                    IO::All

                    Inline

                    Inline::C

                    Perl::Critic

                    Perl::Tidy

                    Pod::Coverage::TrustPod

                    Pod::Weaver::Section::Support

                    String::ShellQuote

                    Test::CPAN::Changes

                    Test::Code::TidyAll

                    Test::Differences

                    Test::EOL

                    Test::Kwalitee

                    Test::NoTabs

                    Test::Pod

                    Test::Pod::Coverage

                    Test::RunValgrind

                    Test::Some

                    Test::TrailingSpace

                    Test::Trap'
        -   name: install and test_script code
            run: '@echo on

                SET PY3MODS=cookiecutter cffi pycotap pydistman pysol_cards pytest
                pytest-cov random2 six tox tox-appveyor wheel

                SET TOXENV=py310

                SET TOX_APPVEYOR_X64=1

                SET PATH=C:\Python38-x64;%PATH%

                python38 --version || ( echo Failed & exit /B 1 )

                python3 --version || ( echo Failed & exit /B 1 )

                python3 -mpip install %PY3MODS% || ( echo Failed & exit /B 1 )

                perl -v || ( echo Failed & exit /B 1 )

                if not exist C:\Perl5 mkdir C:\Perl5 || ( echo Failed & exit /B 1
                )

                SET PERL5LIB=C:/Perl5/lib/perl5

                SET PERL_LOCAL_LIB_ROOT=C:/Perl5

                SET PERL_MB_OPT=--install_base C:/Perl5

                SET PERL_MM_OPT=INSTALL_BASE=C:/Perl5

                pkg-config --version || ( echo Failed & exit /B 1 )

                cd black-hole-solitaire\Games-Solitaire-BlackHole-Solver || ( echo
                Failed & exit /B 1 )

                dzil authordeps --missing | cpanm -n || ( echo Failed & exit /B 1
                )

                dzil listdeps   --missing | cpanm -n || ( echo Failed & exit /B 1
                )

                pkg-config --version || ( echo Failed & exit /B 1 )

                pkg-config --version || ( echo Failed & exit /B 1 )

                set CMAKE_MAKE_PROGRAM=C:\strawberry\c\bin\gmake.exe

                cd ..\.. || ( echo Failed & exit /B 1 )

                pkg-config --version || ( echo Failed & exit /B 1 )

                set TOXENV=py310

                set bhslibdir=%HOME%\apps\fcs\lib

                SET PATH=%PATH%;%bhslibdir%

                set bhslibdir2=%HOME%\apps\fcs\bin

                SET PATH=%PATH%;%bhslibdir2%

                perl black-hole-solitaire/CI-testing/continuous-integration-testing.pl
                --gen="MSYS Makefiles" || ( echo Failed & exit /B 1 )

                '
            shell: cmd
        strategy:
            fail-fast: true
            matrix:
                perl-version:
                - '5.30'
name: windows-x64
'on':
- push
